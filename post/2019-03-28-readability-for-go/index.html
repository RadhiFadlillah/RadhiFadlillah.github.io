<!doctype html><html>
<head>
<title>Readability for Go - Radhi Fadlillah</title>
<meta name=twitter:title content="Readability for Go - Radhi Fadlillah">
<meta property=og:title content="Readability for Go - Radhi Fadlillah">
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="ie=edge">
<meta name=description content="This post is an introduction for go-readability, a library for fetching the readable content from a web page. It’s released under MIT license and available here.">
<meta name=twitter:description content="This post is an introduction for go-readability, a library for fetching the readable content from a web page. It’s released under MIT license and available here.">
<meta property=og:description content="This post is an introduction for go-readability, a library for fetching the readable content from a web page. It’s released under MIT license and available here.">
<link rel=stylesheet href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600,700">
<link rel=stylesheet href="https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700">
<link rel=stylesheet href=/css/stylesheet.css>
<link rel=stylesheet href=/css/dracula.css>
<link rel=apple-touch-icon-precomposed sizes=144x144 href=/res/apple-touch-icon-144x144.png>
<link rel=apple-touch-icon-precomposed sizes=152x152 href=/res/apple-touch-icon-152x152.png>
<link rel=icon type=image/png href=/res/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/res/favicon-16x16.png sizes=16x16>
<link rel="shortcut icon" href=/res/favicon.ico>
</head>
<body>
<div id=header>
<div class=content>
<a id=text-logo href=/>Radhi Fadlillah</a>
<div class=spacer></div>
<a href=/page/about class=header-link>About</a>
</div>
</div>
<div id=body>
<div class=content id=content-post>
<div id=post-metadata>
<a id=post-category href=/category/side-project>
side-project
</a>
<p id=post-title>Readability for Go</p>
<div id=post-time>
<p id=post-author>Radhi Fadlillah</p>
<p id=post-created>2019-03-28 22:29</p>
</div>
</div>
<div id=post-html class=content-html><html><head></head><body><blockquote>
<p>This post is an introduction for <code>go-readability</code>, a library for fetching the readable content from a web page. It’s released under MIT license and available <a href=https://github.com/go-shiori/go-readability>here</a>.</p>
</blockquote>
<p>I’ve been working on a simple bookmark manager called <a href=https://github.com/RadhiFadlillah/shiori>Shiori</a> on and off for the last few months. It’s main feature is the ability to save the main content of a web page as text which can be easily searched later. To do so, it depends on my own package called <a href=https://github.com/go-shiori/go-readability><code>go-readability</code></a>.</p>
<p>The problem is, <code>go-readability</code> was based on old project by <a href=https://github.com/ying32/readability><code>ying32</code></a> which hasn’t been updated for almost a year. The parse result from it was good, but still not comparable to result from reader mode in Firefox. So, I decided to rewrite everything to make sure it follows the code in <a href=https://github.com/mozilla/readability>Readability.js</a> that used by Firefox.</p>
<p>After almost a month, I finished the rewrite. The rewrite was done carefully line by line to make sure it looks and works as similar as possible with Readability.js. This way, hopefully all web page that can be parsed by Readability.js are parse-able by <code>go-readability</code> as well. And, if there are new improvements in Readability.js, it should be easy enough to implement it.</p>
<p>As usual, <code>go-readability</code> is published in <a href=https://github.com/go-shiori/go-readability>Github</a> under MIT license. To install this package, assuming you already installed Go, you can just run :</p>
<pre><code><pre class=chroma>go get -u -v github.com/go-shiori/go-readability</pre></code></pre>
<p>Then you can use it in your code like this :</p>
<pre><code class=language-go><pre class=chroma><span class=kn>package</span> <span class=nx>main</span>

<span class=kn>import</span> <span class=p>(</span>
	<span class=s>&#34;fmt&#34;</span>
	<span class=s>&#34;log&#34;</span>
	<span class=s>&#34;os&#34;</span>
	<span class=s>&#34;time&#34;</span>

	<span class=nx>readability</span> <span class=s>&#34;github.com/go-shiori/go-readability&#34;</span>
<span class=p>)</span>

<span class=kd>var</span> <span class=p>(</span>
	<span class=nx>urls</span> <span class=p>=</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{</span>
		<span class=c1>// this one is article, so it&#39;s parse-able
</span><span class=c1></span>		<span class=s>&#34;https://www.nytimes.com/2019/02/20/climate/climate-national-security-threat.html&#34;</span><span class=p>,</span>
		<span class=c1>// while this one is not an article, so readability will fail to parse.
</span><span class=c1></span>		<span class=s>&#34;https://www.nytimes.com/&#34;</span><span class=p>,</span>
	<span class=p>}</span>
<span class=p>)</span>

<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
	<span class=k>for</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>url</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>urls</span> <span class=p>{</span>
		<span class=nx>article</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>readability</span><span class=p>.</span><span class=nf>FromURL</span><span class=p>(</span><span class=nx>url</span><span class=p>,</span> <span class=mi>30</span><span class=o>*</span><span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span>
		<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
			<span class=nx>log</span><span class=p>.</span><span class=nf>Fatalf</span><span class=p>(</span><span class=s>&#34;failed to parse %s, %v\n&#34;</span><span class=p>,</span> <span class=nx>url</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
		<span class=p>}</span>

		<span class=nx>dstTxtFile</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Create</span><span class=p>(</span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;text-%02d.txt&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=o>+</span><span class=mi>1</span><span class=p>))</span>
		<span class=k>defer</span> <span class=nx>dstTxtFile</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
		<span class=nx>dstTxtFile</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=nx>article</span><span class=p>.</span><span class=nx>TextContent</span><span class=p>)</span>

		<span class=nx>dstHTMLFile</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Create</span><span class=p>(</span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;html-%02d.html&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=o>+</span><span class=mi>1</span><span class=p>))</span>
		<span class=k>defer</span> <span class=nx>dstHTMLFile</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
		<span class=nx>dstHTMLFile</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=nx>article</span><span class=p>.</span><span class=nx>Content</span><span class=p>)</span>

		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;URL     : %s\n&#34;</span><span class=p>,</span> <span class=nx>url</span><span class=p>)</span>
		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Title   : %s\n&#34;</span><span class=p>,</span> <span class=nx>article</span><span class=p>.</span><span class=nx>Title</span><span class=p>)</span>
		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Author  : %s\n&#34;</span><span class=p>,</span> <span class=nx>article</span><span class=p>.</span><span class=nx>Byline</span><span class=p>)</span>
		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Length  : %d\n&#34;</span><span class=p>,</span> <span class=nx>article</span><span class=p>.</span><span class=nx>Length</span><span class=p>)</span>
		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Excerpt : %s\n&#34;</span><span class=p>,</span> <span class=nx>article</span><span class=p>.</span><span class=nx>Excerpt</span><span class=p>)</span>
		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;SiteName: %s\n&#34;</span><span class=p>,</span> <span class=nx>article</span><span class=p>.</span><span class=nx>SiteName</span><span class=p>)</span>
		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Image   : %s\n&#34;</span><span class=p>,</span> <span class=nx>article</span><span class=p>.</span><span class=nx>Image</span><span class=p>)</span>
		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Favicon : %s\n&#34;</span><span class=p>,</span> <span class=nx>article</span><span class=p>.</span><span class=nx>Favicon</span><span class=p>)</span>
		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Text content saved to \&#34;text-%02d.txt\&#34;\n&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span>
		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;HTML content saved to \&#34;html-%02d.html\&#34;\n&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span>
		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>()</span>
	<span class=p>}</span>
<span class=p>}</span></pre></code></pre>
<p>If you want to use the CLI app, you can install it by running :</p>
<pre><code><pre class=chroma>go get -u -v github.com/go-shiori/go-readability/cmd/...</pre></code></pre>
<p>Then you can use it like this :</p>
<pre><code><pre class=chroma>go-readability &lt;url&gt;</pre></code></pre>
</body></html></div>
<div id=post-tags>
<a href=/tag/go># go</a>
<a href=/tag/golang># golang</a>
</div>
</div>
</div>
<div id=footer>
<div class=content>
<p>© 2019 Radhi Fadlillah. Made with <a href=https://github.com/go-spook/spook>Spook</a>
using the <a href=https://github.com/go-spook/basic-theme>Basic</a> theme.</p>
</div>
</div>
</body>
</html>